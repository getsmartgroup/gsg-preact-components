var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,l=(t,n,o)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o,a=(e,t)=>{for(var n in t||(t={}))r.call(t,n)&&l(e,n,t[n]);if(o)for(var n of o(t))i.call(t,n)&&l(e,n,t[n]);return e},s=(e,t)=>{var n={};for(var l in e)r.call(e,l)&&t.indexOf(l)<0&&(n[l]=e[l]);if(null!=e&&o)for(var l of o(e))t.indexOf(l)<0&&i.call(e,l)&&(n[l]=e[l]);return n};import{q as c,l as u,a as d,F as h,y as p,B as m,b as v,C as y,A as g,c as f,d as b,e as S,f as C,H as P,g as I,V as O,R as j,S as w,h as _,i as k,j as x,k as T,T as D,m as A,n as N,o as L,p as E,r as q,s as G,t as R,u as $,v as M,w as z,x as B,z as U,D as K,I as Q,E as F,G as V,W,J as H,K as J,L as X,M as Y,N as Z,O as ee,P as te,Q as ne,U as oe,X as re,Y as ie,Z as le,_ as ae,$ as se}from"./vendor.js";class ce{getID(){return this.data.id}constructor(e){var t,n;this.data=e,this.coloredParts=["shell","cabinet"].map((t=>{var n,o;const r=e[t+"Image"];return{name:t,image:null==(n=null==r?void 0:r[0])?void 0:n.url,color:null==(o=e[t+"Color"])?void 0:o[0]}})),this.combinedColor=null!=(n=null==(t=this.data.combinationColor)?void 0:t[0])?n:null}get combinedImage(){var e,t;return null==(t=null==(e=this.data.combinationImage)?void 0:e[0])?void 0:t.url}}const ue=async e=>{return(t="https://api.baseql.com/airtable/graphql/appMt27Uj2WHfsPP7",n=`\n\tproductColorCombinations( product : "${e}" ) {\n\t\tid\n\t\tshellColor {\n\t\t\tid\n\t\t\tname\n\t\t\timage\n\t\t}\n\t\tcabinetColor {\n\t\t\tid\n\t\t\tname\n\t\t\timage\n\t\t}\n\t\tcombinationImage\n\t\tshellImage\n\t\tcabinetImage\n\t\tcombinationColor {\n\t\t\tid\n\t\t\tname\n\t\t\timage\n\t\t}\n\t}\n\t`,fetch(t,{method:"POST",body:JSON.stringify({query:`{${n}}`}),headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((e=>e.json())).then((e=>e.data))).then((e=>(console.log(e),e))).then((e=>{var t;return null==(t=null==e?void 0:e.productColorCombinations)?void 0:t.map((e=>new ce(e)))}));var t,n},de=(e,o)=>{let r=e;const i=e=>{r=a(a({},r),e),o(r)},l=e=>t=>i({[e]:t}),s=l("combinations"),c=l("error"),u=l("colorsIndex"),d=l("combinedColors"),h=(e,t)=>{var n,o;const i={},l=r.combinations.filter((n=>{for(const o of n.coloredParts)if(o.name===e&&o.color&&o.color.name!==t)return!1;return!0})),a=[];for(const c of l){let e=0;for(const t of c.coloredParts)t.color&&r.selectedPartColors[t.name]===t.color.name&&e++;a[e]=c}const s=a.pop();if(null==s?void 0:s.coloredParts)for(const r of s.coloredParts)(null==(n=null==r?void 0:r.color)?void 0:n.name)&&(null==r?void 0:r.name)&&(i[r.name]=null==(o=null==r?void 0:r.color)?void 0:o.name);return i},p=e=>{const t=r.selectedPartColors;return r.combinations.filter((n=>{for(const o of n.coloredParts)if(o.name!==e&&t[o.name]&&o.color&&t[o.name]!==o.color.name)return!1;return!0}),[])},m=e=>{var t,n;return null!=(n=null==(t=p(e))?void 0:t.reduce(((t,n)=>(n.coloredParts.forEach((n=>{var o;(null==n?void 0:n.name)===e&&(null==(o=null==n?void 0:n.color)?void 0:o.name)&&t.push(n.color.name)})),t)),[]))?n:[]},v=(e,t)=>m(e).includes(t);return{state:r,actions:{setCombinations:s,setError:c,setColorsIndexedByPart:e=>{l("colorsIndexedByPart")(e)},setColorsIndex:u,setCombinedColors:d,selectPartColor:(e,o)=>{var l,s;v(e,o)?i({selectedPartColors:(l=a({},r.selectedPartColors),s={[e]:o},t(l,n(s)))}):i({selectedPartColors:h(e,o)})},selectCombinedColor:e=>{i({selectedCombinedColor:e})}},utilities:{getCompatibleCombinationsFor:p,getCompatibleColorsFor:m,isCompatiblePartColor:v,getSelectionCompatibleWith:h,getSelectedCombination:()=>{var e;return null==(e=null==r?void 0:r.combinations)?void 0:e.find((e=>{var t;if(e.coloredParts.length>0){for(const n of e.coloredParts)if(!r.selectedPartColors[n.name]||r.selectedPartColors[n.name]!==(null==(t=null==n?void 0:n.color)?void 0:t.name))return!1;return!0}return!1}))}}}},he=c(null),pe=()=>{var e;return null==(e=h(he))?void 0:e.state},me=()=>{var e;return null==(e=h(he))?void 0:e.actions},ve=()=>{var e;return null==(e=h(he))?void 0:e.utilities},ye=({children:e})=>{const[t,n]=u({combinations:[],colorsIndexedByPart:{},selectedPartColors:{}});return d(he.Provider,{value:de(t,n)},e)},ge=()=>{const{error:e}=pe();return console.log("[ERROR]",e),d("div",null,d("div",null,"An Error Occurred"),d("p",null,null==e?void 0:e.name),d("p",null,null==e?void 0:e.stack))},fe=()=>{var e,t;const{combinations:n,selectedCombinedColor:o}=pe(),{getSelectedCombination:r}=ve(),i=r(),l=o?[null==(e=n.find((e=>{var t;return(null==(t=null==e?void 0:e.combinedColor)?void 0:t.name)===o})))?void 0:e.combinedImage]:(null==i?void 0:i.combinedImage)?[i.combinedImage]:null==(t=null==i?void 0:i.coloredParts)?void 0:t.map((e=>null==e?void 0:e.image));return l?d(m,{w:"full",position:"relative"},l.filter((e=>e)).map((e=>d("img",{src:e,class:"gsg-procuts-hot-tub"})))):null},be=()=>{var e;const{colorsIndexedByPart:t,colorsIndex:n,selectedPartColors:o,combinedColors:r,selectedCombinedColor:i}=pe(),{selectPartColor:l,selectCombinedColor:a}=me(),{isCompatiblePartColor:s}=ve(),c=Object.entries(t).reduce(((e,[t,r])=>{const i=[],a=[];r.forEach((e=>{var r,c,u;const h=s(t,e),p=null==n?void 0:n[e];if(p){const e={width:"60px",outline:o[t]===(null==p?void 0:p.image)?"1px solid rgba(0,0,0,0.1)":"",opacity:h?1:.5},n=d("li",{style:e,onClick:()=>l(t,null==p?void 0:p.name)},d("img",{style:{width:"60px",height:"60px",objectFit:"cover",position:"static",margin:"auto"},src:null!=(u=null==(c=null==(r=null==p?void 0:p.image)?void 0:r[0])?void 0:c.url)?u:"",alt:`${null==p?void 0:p.name} ${t}`}));h?i.push(n):a.push(n)}}),[]);const c=[];return i.length>0&&c.push(d("div",{style:{marginBottom:20}},d("div",{style:{marginBottom:7}},d("b",null,"Compatible ",t," Colors")),d("ul",{style:{display:"flex",flexWrap:"wrap",listStyle:"none",margin:"0",gap:"16px"}},i))),a.length>0&&c.push(d("div",null,d("div",{style:{marginBottom:7}},d("b",null,"Other ",t," Colors")),d("ul",{style:{display:"flex",flexWrap:"wrap",listStyle:"none",margin:"0",gap:"16px"}},a))),e.push(d("div",{style:{display:"flex"}},c)),e}),[]);if(r&&(null==r?void 0:r.length)>0){const t=null!=(e=null==r?void 0:r.reduce(((e,t)=>{var o,r;const l=null==n?void 0:n[t];return l&&e.push(d("li",{style:{width:"150px",outline:i===(null==l?void 0:l.name)?"1px solid rgba(0,0,0,0.1)":""},onClick:()=>a(null==l?void 0:l.name)},d("img",{style:{width:"100%"},src:null==(r=null==(o=null==l?void 0:l.image)?void 0:o[0])?void 0:r.url,alt:`${null==l?void 0:l.name}`}))),e}),[]))?e:[];c.push(d("div",null,d("div",null,d("b",null,"Combined Colors")),d("ul",{style:{display:"flex",flexWrap:"wrap",listStyle:"none",margin:"0",gap:"16px"}},t)))}return d(v,null,c)},Se=()=>d("div",{class:"gsg-color-selector"},d("h3",null,"Color Selector"),d("div",{style:{display:"flex",justifyContent:"space-around"}},d(fe,null),d(be,null))),Ce=({product:e})=>{const{setCombinations:t,setError:n,setColorsIndexedByPart:o,setColorsIndex:r,setCombinedColors:i,selectCombinedColor:l,selectPartColor:a}=me(),{error:s,selectedPartColors:c,selectedCombinedColor:u,combinedColors:h,colorsIndexedByPart:m}=pe(),{isCompatiblePartColor:v}=ve();if(null==h?void 0:h[0]){const e=h[0];!u&&e&&l(e)}else for(const[d,p]of Object.entries(m))if(!c[d])for(const e of p)e&&v(d,e)&&a(d,e);return p((()=>{ue(e).then((e=>{var n,l,a;t(e),o(null!=(n=null==e?void 0:e.reduce(((e,t)=>{var n;return null==(n=null==t?void 0:t.coloredParts)||n.forEach((t=>{var n;if(t.color){let o=null!=(n=e[t.name])?n:[];t.color.name&&!o.includes(t.color.name)&&o.push(t.color.name),e[t.name]=o}})),e}),{}))?n:{}),r(null!=(l=null==e?void 0:e.reduce(((e,t)=>{var n,o,r;return(null==t?void 0:t.combinedColor)&&(null==(n=null==t?void 0:t.combinedColor)?void 0:n.name)&&!e[null==(o=null==t?void 0:t.combinedColor)?void 0:o.name]?e[null==(r=null==t?void 0:t.combinedColor)?void 0:r.name]=null==t?void 0:t.combinedColor:t.coloredParts.forEach((t=>{var n,o,r;(null==(n=t.color)?void 0:n.name)&&!e[null==(o=t.color)?void 0:o.name]&&(e[null==(r=null==t?void 0:t.color)?void 0:r.name]=t.color)})),e}),{}))?l:{}),i(null!=(a=null==e?void 0:e.reduce(((e,t)=>{var n;return(null==(n=null==t?void 0:t.combinedColor)?void 0:n.name)&&!e.includes(t.combinedColor.name)&&e.push(t.combinedColor.name),e}),[]))?a:{})})).catch(n)}),[e]),d("div",null,d(s?ge:Se,null))},Pe="https://gsg-heroku-proxy.herokuapp.com/https://cloud3.evosus.com/api".replace(/\/+$/,"");class Ie extends Error{constructor(e,t){super(t),this.field=e,this.name="RequiredError"}}const Oe="https://example.com",je=function(e,t,n){if(null==n)throw new Ie(t,`Required parameter ${t} was null or undefined when calling ${e}.`)},we=function(e,...t){const n=new URLSearchParams(e.search);for(const o of t)for(const e in o)if(Array.isArray(o[e])){n.delete(e);for(const t of o[e])n.append(e,t)}else n.set(e,o[e]);e.search=n.toString()},_e=function(e,t,n){const o="string"!=typeof e;return(o&&n&&n.isJsonMime?n.isJsonMime(t.headers["Content-Type"]):o)?JSON.stringify(void 0!==e?e:{}):e||""},ke=function(e){return e.pathname+e.search+e.hash},xe=function(e,t,n,o){return(r=t,i=n)=>{const l=Object.assign(Object.assign({},e.options),{url:((null==o?void 0:o.basePath)||i)+e.url});return r.request(l)}};var Te=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function l(e){try{s(o.next(e))}catch(t){i(t)}}function a(e){try{s(o.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,a)}s((o=o.apply(e,t||[])).next())}))};const De=function(e){const t=function(e){return{inventoryDistributionMethodSearch:(t,n,o={})=>Te(this,void 0,void 0,(function*(){je("inventoryDistributionMethodSearch","companySN",t),je("inventoryDistributionMethodSearch","ticket",n);const r=new URL("/method/Inventory_DistributionMethod_Search",Oe);let i;e&&(i=e.baseOptions);const l=Object.assign(Object.assign({method:"POST"},i),o),a={};void 0!==t&&(a.CompanySN=t),void 0!==n&&(a.ticket=n),we(r,a,o.query);let s=i&&i.headers?i.headers:{};return l.headers=Object.assign(Object.assign(Object.assign({},{}),s),o.headers),{url:ke(r),options:l}})),inventoryItemGet:(t,n,o,r={})=>Te(this,void 0,void 0,(function*(){je("inventoryItemGet","companySN",t),je("inventoryItemGet","ticket",n),je("inventoryItemGet","body",o);const i=new URL("/method/Inventory_Item_Get",Oe);let l;e&&(l=e.baseOptions);const a=Object.assign(Object.assign({method:"POST"},l),r),s={},c={};void 0!==t&&(c.CompanySN=t),void 0!==n&&(c.ticket=n),s["Content-Type"]="application/json",we(i,c,r.query);let u=l&&l.headers?l.headers:{};return a.headers=Object.assign(Object.assign(Object.assign({},s),u),r.headers),a.data=_e(o,a,e),{url:ke(i),options:a}})),inventoryItemSearch:(t,n,o,r={})=>Te(this,void 0,void 0,(function*(){je("inventoryItemSearch","companySN",t),je("inventoryItemSearch","ticket",n),je("inventoryItemSearch","body",o);const i=new URL("/method/Inventory_Item_Search",Oe);let l;e&&(l=e.baseOptions);const a=Object.assign(Object.assign({method:"POST"},l),r),s={},c={};void 0!==t&&(c.CompanySN=t),void 0!==n&&(c.ticket=n),s["Content-Type"]="application/json",we(i,c,r.query);let u=l&&l.headers?l.headers:{};return a.headers=Object.assign(Object.assign(Object.assign({},s),u),r.headers),a.data=_e(o,a,e),{url:ke(i),options:a}})),inventoryItemStockSiteQuantityGet:(t,n,o,r={})=>Te(this,void 0,void 0,(function*(){je("inventoryItemStockSiteQuantityGet","companySN",t),je("inventoryItemStockSiteQuantityGet","ticket",n);const i=new URL("/method/Inventory_Item_StockSiteQuantity_Get",Oe);let l;e&&(l=e.baseOptions);const a=Object.assign(Object.assign({method:"POST"},l),r),s={},c={};void 0!==t&&(c.CompanySN=t),void 0!==n&&(c.ticket=n),s["Content-Type"]="application/json",we(i,c,r.query);let u=l&&l.headers?l.headers:{};return a.headers=Object.assign(Object.assign(Object.assign({},s),u),r.headers),a.data=_e(o,a,e),{url:ke(i),options:a}})),inventoryProductLineSearch:(t,n,o={})=>Te(this,void 0,void 0,(function*(){je("inventoryProductLineSearch","companySN",t),je("inventoryProductLineSearch","ticket",n);const r=new URL("/method/Inventory_ProductLine_Search",Oe);let i;e&&(i=e.baseOptions);const l=Object.assign(Object.assign({method:"POST"},i),o),a={};void 0!==t&&(a.CompanySN=t),void 0!==n&&(a.ticket=n),we(r,a,o.query);let s=i&&i.headers?i.headers:{};return l.headers=Object.assign(Object.assign(Object.assign({},{}),s),o.headers),{url:ke(r),options:l}})),inventoryVendorSearch:(t,n,o,r={})=>Te(this,void 0,void 0,(function*(){je("inventoryVendorSearch","companySN",t),je("inventoryVendorSearch","ticket",n),je("inventoryVendorSearch","body",o);const i=new URL("/method/Inventory_Vendor_Search",Oe);let l;e&&(l=e.baseOptions);const a=Object.assign(Object.assign({method:"POST"},l),r),s={},c={};void 0!==t&&(c.CompanySN=t),void 0!==n&&(c.ticket=n),s["Content-Type"]="application/json",we(i,c,r.query);let u=l&&l.headers?l.headers:{};return a.headers=Object.assign(Object.assign(Object.assign({},s),u),r.headers),a.data=_e(o,a,e),{url:ke(i),options:a}}))}}(e);return{inventoryDistributionMethodSearch(n,o,r){return Te(this,void 0,void 0,(function*(){const i=yield t.inventoryDistributionMethodSearch(n,o,r);return xe(i,y,Pe,e)}))},inventoryItemGet(n,o,r,i){return Te(this,void 0,void 0,(function*(){const l=yield t.inventoryItemGet(n,o,r,i);return xe(l,y,Pe,e)}))},inventoryItemSearch(n,o,r,i){return Te(this,void 0,void 0,(function*(){const l=yield t.inventoryItemSearch(n,o,r,i);return xe(l,y,Pe,e)}))},inventoryItemStockSiteQuantityGet(n,o,r,i){return Te(this,void 0,void 0,(function*(){const l=yield t.inventoryItemStockSiteQuantityGet(n,o,r,i);return xe(l,y,Pe,e)}))},inventoryProductLineSearch(n,o,r){return Te(this,void 0,void 0,(function*(){const i=yield t.inventoryProductLineSearch(n,o,r);return xe(i,y,Pe,e)}))},inventoryVendorSearch(n,o,r,i){return Te(this,void 0,void 0,(function*(){const l=yield t.inventoryVendorSearch(n,o,r,i);return xe(l,y,Pe,e)}))}}};class Ae extends class{constructor(e,t=Pe,n=y){this.basePath=t,this.axios=n,e&&(this.configuration=e,this.basePath=e.basePath||this.basePath)}}{inventoryDistributionMethodSearch(e,t,n){return De(this.configuration).inventoryDistributionMethodSearch(e,t,n).then((e=>e(this.axios,this.basePath)))}inventoryItemGet(e,t,n,o){return De(this.configuration).inventoryItemGet(e,t,n,o).then((e=>e(this.axios,this.basePath)))}inventoryItemSearch(e,t,n,o){return De(this.configuration).inventoryItemSearch(e,t,n,o).then((e=>e(this.axios,this.basePath)))}inventoryItemStockSiteQuantityGet(e,t,n,o){return De(this.configuration).inventoryItemStockSiteQuantityGet(e,t,n,o).then((e=>e(this.axios,this.basePath)))}inventoryProductLineSearch(e,t,n){return De(this.configuration).inventoryProductLineSearch(e,t,n).then((e=>e(this.axios,this.basePath)))}inventoryVendorSearch(e,t,n,o){return De(this.configuration).inventoryVendorSearch(e,t,n,o).then((e=>e(this.axios,this.basePath)))}}const Ne=e=>{var t=e,{children:n,itemProps:o}=t,r=s(t,["children","itemProps"]);return d(f,a({w:"100%",allowMultiple:!1,allowToggle:!0},r),(Array.isArray(n)?n:[n]).map((e=>d(g,null,e))))},Le=e=>{var t=e,{children:n,title:o}=t,r=s(t,["children","title"]);return d(v,null,d(S,{w:"100%"},d(C,{w:"100%",alignItems:"center",justifyContent:"space-between"},d(P,{size:"md"},o),d(I,null))),d(b,a({},r),n))},Ee=e=>{const[t,n]=u(null),[o,r]=u(null),[i,l]=u(null),[a,s]=u(["price","quantity","name","weight"]),[c,h]=u(!1),[v,y]=u(null);p((()=>{(({ticket:e,companySN:t,gsgToken:n,clientID:o})=>t&&e?n&&o?Promise.resolve({ticket:e,companySN:t,gsgToken:n,clientID:o}):Promise.reject("Invalid GSG access credentials"):Promise.reject("Invalid evosus access credentials"))(e).then((({ticket:e,companySN:t})=>(async(e,{companySN:t,ticket:n})=>{const o=await e.inventoryProductLineSearch(t,n).then((e=>e.data.response));return o?Promise.resolve(o):Promise.reject("Failed to retrieve product line items from Evosus API")})(new Ae,{ticket:e,companySN:t}).then(n).then(r.bind(null,null)))).catch(r)}),[e]);return d(m,null,d(P,{w:"100%",size:"md"},"GSG Evosus Dashboard"),d(m,null,o?d(R,{status:"error"},d($,null),d(M,{mr:2},o),d(z,null)):null),d(Ne,null,d(Le,{title:"Sync Products"},d(O,{w:"100%",justifyContent:"stretch",alignItems:"stretch",alignContent:"stretch",justifyItems:"stretch"},d(P,{size:"sm"},"Select a product Line"),null===t?"Loading Product Lines":null,d(j,{onChange:l,value:null!=i?i:""},d(w,{columns:2},null==t?void 0:t.map((({ProductLine:e,ProductLineID:t})=>d(_,{value:null==t?void 0:t.toString()},e))))),d(P,{size:"sm"},"Select which properties should be synced"),d(k,{onChange:e=>s(e),value:a},d(w,null,d(x,{value:"name"},"Product Name"),d(x,{value:"price"},"Price"),d(x,{value:"quantity"},"Quantity"),d(x,{value:"weight"},"Weight"))),d(m,null,d(T,{onClick:()=>{h(!0),fetch(`https://us-central1-get-smart-functions.cloudfunctions.net/main/evosus/products/sync?client=${e.clientID}`,{method:"POST",body:JSON.stringify({search:{productLineID:i},fields:a}),headers:{authorization:`Bearer ${e.gsgToken}`,"content-type":"application/json"}}).then((async e=>{if(408===e.status)throw r("The request timed out, you may try again to finish syncing"),new Error(await e.text());return 200!==e.status?(r(null),e.json()):e.json()})).then(y).then(r.bind(null,null)).catch(r.bind(null,"Error while syncing")).finally(h.bind(null,!1))},w:"100%",mt:8,disabled:c||!i||0===a.length},"Sync Products")),d(m,null,c?"Syncing...":null),d(f,{allowMultiple:!0},null==v?void 0:v.map((e=>{var t,n,o;return d(g,{bg:"fulfilled"===e.status?"green.400":"red.400"},d(S,null,d(m,{flex:"1",textAlign:"left"},"fulfilled"===e.status?"Success":"Failure",": ","fulfilled"===e.status?(null==(t=e.value.update)?void 0:t.length)||(null==(n=e.value.create)?void 0:n.length):null," ","fulfilled"===e.status?e.value.update?"Updated":e.value.create?"Created":null:null),d(I,null)),d(b,{pb:4,bg:"white"},d(D,{variant:"simple"},d(A,null,d(N,null,d(L,null,"ID#"),d(L,null,"Name"),d(L,null,"SKU"),d(L,null,"Quanitity"),d(L,null,"Price"))),d(E,null,"fulfilled"===e.status?null==(o=e.value.update||e.value.create)?void 0:o.map((e=>d(N,null,d(q,null,e.id),d(q,null,e.name),d(q,null,e.sku),d(q,null,e.stock_quantity),d(q,null,e.price)))):null),d(G,null,d(N,null,d(L,null,"ID#"),d(L,null,"Name"),d(L,null,"SKU"),d(L,null,"Quanitity"),d(L,null,"Price"))))))})))))))},qe=(e,t=[])=>{const[n,o]=u(null),[r,i]=u(null),[l,a]=B(!0);return p((()=>{o(null),i(null),a.on(),e&&e().then(o).catch(i).finally(a.off)}),t),{resolved:n,rejected:r,loading:l}},Ge=e=>{const[t,n]=u(e);return{array:t,set:n,push:e=>n([...t,e]),concat:e=>n([...t,...e]),remove:e=>n(t.filter((t=>t!==e)))}},Re=e=>{if("object"==typeof e&&null!==e){if("function"==typeof Object.getPrototypeOf){const t=Object.getPrototypeOf(e);return t===Object.prototype||null===t}return"[object Object]"===Object.prototype.toString.call(e)}return!1},$e=(...e)=>e.reduce(((e,t)=>(Object.keys(t).forEach((n=>{Array.isArray(e[n])&&Array.isArray(t[n])?e[n]=Array.from(new Set(e[n].concat(t[n]))):Re(e[n])&&Re(t[n])?e[n]=$e(e[n],t[n]):e[n]=t[n]})),e)),{}),Me=({nonce:e,siteurl:t,cookieHash:n,cookieValue:o,gsgToken:r})=>{const i=K((()=>(({nonce:e,siteurl:t,cookieHash:n,cookieValue:o,gsgToken:r})=>{!r&&n&&o&&V.set(n,o);const i={"content-type":"application/json"};return r?i.Authorization=`Bearer ${r}`:i["X-WP-Nonce"]=e,{get:()=>fetch(`${t}/wp-json/gsg/v1/options`,{headers:i,credentials:"include"}).then((e=>e.json())),set:e=>fetch(`${t}/wp-json/gsg/v1/options`,{headers:i,credentials:"include",method:"POST",body:JSON.stringify(e)}).then((e=>e.json()))}})({nonce:e,siteurl:t,cookieHash:n,cookieValue:o,gsgToken:r})),[e,t,n,o,r]),[l,s]=B(!1),[c,h]=B(!0),[m,v]=u({gsc:{options:{access:{clientID:"",gsgToken:""}}},wc:{options:{access:{key:"",secret:"",url:""}}},evosus:{access:{companySN:"",ticket:""}},rb:{options:{access:{CompanyID:"",APIKey:"",name:""}}},an:{options:{credentials:{name:"",refId:"",transactionKey:""},testMode:!0}}});p((()=>{h.on(),i.get().then((e=>{var t,n,o,r;if(void 0!==(null==(r=null==(o=null==(n=null==(t=null==e?void 0:e.gsc)?void 0:t.options)?void 0:n.access)?void 0:o.gsgToken)?void 0:r.length)){const t=$e(m,e);v(a({},t))}})).finally(h.off)}),[e,t,n,o,r]),p((()=>{var e;!c&&!l&&(null==(e=m.gsc.options.access.gsgToken)?void 0:e.length)>0&&(s.on(),i.set(m).finally(s.off.bind(null)))}),[m]);return{optionInput:(e,t,n)=>{const o=e[t];return d(F.label,null,n,d(Q,{disabled:c,placeholder:n,value:e[t],onChange:n=>{const o=n.target.value;e[t]=o},onBlur:()=>{console.log(e[t],o),e[t]!==o&&v(a({},m))}}))},fetching:c,saving:l,options:m}},[ze,Be]=U(),Ue=e=>{var t=e,{children:n}=t,o=s(t,["children"]);const r=Me(o);return d(ze,{value:r},n)};var Ke=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function l(e){try{s(o.next(e))}catch(t){i(t)}}function a(e){try{s(o.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,a)}s((o=o.apply(e,t||[])).next())}))};const Qe=e=>t=>Ke(void 0,void 0,void 0,(function*(){let n=!0;const o=[];for(t.per_page=100,t.page=1;!0===n;)try{const r=yield e(t);r.length<100?n=!1:t.page+=1,o.push(...r)}catch(r){return Promise.reject(r)}return Promise.resolve(o)})),Fe=(e,t)=>{const n=n=>e.get(t,n).then((e=>e.data));return{create:n=>e.post(t,n).then((e=>e.data)),retrieve:n=>e.get(`${t}/${n}`).then((e=>e.data)),list:n,put:(n,o)=>e.put(`${t}/${n}`,o).then((e=>e.data)),update:(n,o)=>e.put(`${t}/${n}`,o).then((e=>e.data)),delete:(n,o=!1)=>e.delete(`${t}/${n}`,{force:o}).then((e=>e.data)),batch:n=>e.post(`${t}/batch`,n).then((e=>e.data)),getAll:Qe(n)}};var Ve=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",crud:e=>Fe(e,"products")});var We=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",crud:e=>Fe(e,"orders")});var He=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",crud:e=>Fe(e,"customers")}),Je=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",Product:Ve,Order:We,Customer:He});const Xe=e=>{return t=(({key:e,secret:t,url:n})=>new W({url:n,consumerKey:e,consumerSecret:t,version:"wc/v3"}))(e.access),Object.entries(Je).reduce(((e,[n,o])=>(e[n]=Object.assign(Object.assign({},o),{crud:o.crud(t)}),e)),{});var t};var Ye=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function l(e){try{s(o.next(e))}catch(t){i(t)}}function a(e){try{s(o.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,a)}s((o=o.apply(e,t||[])).next())}))};const Ze=(e,t)=>Array.from(Array(Math.ceil(e.length/t)).keys()).map((n=>e.slice(n*t,n*t+t))),et=e=>(t,n,o)=>e.get("/RBXItemSearch",{params:{name:t,dept:n,cat:o}}),tt=(e,t)=>et(e)(t,void 0,void 0).then((e=>e.data)),nt=(e,t)=>n=>et(e)(t,n,void 0).then((e=>e.data)),ot=(e,t)=>(n,o)=>et(e)(t,n,o).then((e=>e.data)),rt=e=>t=>e.post("https://www.rbrsswebservices.com/api/RBXSalesOrder",t).then((e=>e.data)),it=e=>{const t=e.name,n=(e=>y.create({headers:{"Content-Type":"application/json",APIKey:e.APIKey,CompanyID:e.CompanyID},baseURL:"https://www.rbrsswebservices.com/api"}))(e);return{itemSearch:et(n),getDepartments:tt.bind(null,n,t),getCategories:nt(n,t),getProducts:ot(n,t),postOrder:rt(n)}};var lt=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function l(e){try{s(o.next(e))}catch(t){i(t)}}function a(e){try{s(o.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,a)}s((o=o.apply(e,t||[])).next())}))};const at=e=>({AddrLine1:e.address_1,AddrLine2:e.address_2,City:e.city,PostCode:e.postcode,StateProv:e.state}),st=(e,t,n)=>o=>lt(void 0,void 0,void 0,(function*(){return Promise.all(o.map((o=>lt(void 0,void 0,void 0,(function*(){const{Payments:r,CCAuth:i}=yield(l=n,e=>Ye(void 0,void 0,void 0,(function*(){const t=e.transaction_id;if(!t)return Promise.reject(new TypeError("No transaction ID in order"));if(!["authorize_net_cim_credit_card","yith_wcauthnet_credit_card_gateway"].includes(e.payment_method))return Promise.reject(new TypeError("Payment method not supported"));const n=yield l.getTransactionDetails(t);return{CCAuth:n.transaction.authCode,Payments:[{PaymentType:"Credit Card",CCExp:n.transaction.payment.creditCard.expirationDate.replace("/",""),CCHolder:n.transaction.billTo.firstName+" "+n.transaction.billTo.lastName,CCType:n.transaction.payment.creditCard.cardType,CCNum:n.transaction.payment.creditCard.cardNumber.replaceAll("X",""),PmtAmt:parseFloat(n.transaction.requestedAmount)}]}})))(o);var l;const a={BillTo:at(o.billing),ShipTo:at(o.shipping),OrderItems:o.line_items.map((e=>({Product:e.name,Sku:e.sku,Qty:e.quantity,Price:parseFloat(e.total)}))),TransactionType:"Ecommerce Order",Comments:o.customer_note,OrderID:o.id.toString(),Discount:parseFloat(o.discount_total),Shipping:parseFloat(o.shipping_total),Subtotal:parseFloat(o.line_items.reduce(((e,t)=>e+(parseFloat(t.subtotal)||0)),0)),TotalPrice:parseFloat(o.total),Data1:"",Date:o.date_created,Phone:o.billing.phone,Mobile:o.billing.phone,FirstName:o.billing.first_name,LastName:o.billing.last_name,Email:o.billing.email,Payments:r,CCAuth:i};return console.log({rbOrder:a}),yield e.postOrder(a),t.Order.crud.update(o.id,{status:"posted-to-rb"})})))))})),ct=e=>({sku:e.ID.toString(),categories:[{name:e.Category},{name:e.Department}],short_description:e.Description,description:e.LongDescription,regular_price:e.Price.toString(),sale_price:e.SalePrice.toString(),date_on_sale_from:e.SaleStart,date_on_sale_to:e.SaleEnd,stock_quantity:e.Quantity}),ut=e=>t=>e.post("/rb/wc-order",t),dt=e=>({postWCOrder:ut(e)}),ht=e=>e.get("/main/get-services").then((e=>e.data)),pt=e=>{return t=(({gsgToken:e,clientID:t})=>y.create({headers:{Authorization:`Bearer ${e}`},baseURL:"https://us-central1-get-smart-functions.cloudfunctions.net",params:{client:t}}))(e),{rb:dt(t),getServices:ht.bind(null,t)};var t},mt=e=>({client:K((()=>{if(e)return(e=>it(e.access))(e)}),[e])}),[vt,yt]=U(),gt=e=>{var t=e,{children:n}=t,o=s(t,["children"]);const r=mt(o);return r.client?d(vt,{value:r},n):null},ft=yt,[bt,St]=U(),Ct=e=>{var t=e,{children:n}=t,o=s(t,["children"]);const r={client:K((()=>{if(i.access.key&&i.access.url&&i.access.secret&&i)return Xe(i)}),[i=o])};var i;return r.client?d(bt,{value:r},n):null},Pt=St,It=e=>({client:K((()=>{if(e)return(({credentials:e,testMode:t})=>{const n={"Content-Type":"application/json"},o=t?"https://apitest.authorize.net/xml/v1/request.api":"https://api.authorize.net/xml/v1/request.api",r=(t,r)=>y({url:o,method:"POST",headers:n,data:{[t]:Object.assign({merchantAuthentication:{name:e.name,transactionKey:e.transactionKey}},r)}}).then((e=>{var t,n,o,r,i,l;return"Error"===(null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.messages)||void 0===n?void 0:n.resultCode)?Promise.reject(new Error(null===(l=null===(i=null===(r=null===(o=null==e?void 0:e.data)||void 0===o?void 0:o.messages)||void 0===r?void 0:r.message)||void 0===i?void 0:i.map((e=>null==e?void 0:e.text)))||void 0===l?void 0:l.join("\n"))):e.data}));return{post:r,getTransactionDetails:e=>r("getTransactionDetailsRequest",{transId:e}).then((e=>e))}})(e)}),[e])}),[Ot,jt]=U(),wt=e=>{var t=e,{children:n}=t,o=s(t,["children"]);const r=It(o);return r.client?d(Ot,{value:r},n):null},_t=jt,kt=e=>({client:K((()=>{if(e)return(e=>pt(e.access))(e)}),[e])}),[xt,Tt]=U(),Dt=e=>{var t=e,{children:n}=t,o=s(t,["children"]);const r=kt(o);return r.client?d(xt,{value:r},n):null},At=Tt,Nt=e=>{var t=e,{headers:n,children:o}=t,r=s(t,["headers","children"]);const i=K((()=>n.map((e=>d(L,null,e)))),[n]);return d(D,a({whiteSpace:"nowrap",w:"100%",variant:"simple"},r),d(A,null,d(N,null,i)),d(E,null,o),d(G,null,d(N,null,i)))},Lt=e=>{var t,n=e,{options:o}=n,r=s(n,["options"]);return d(j,a({},r),d(w,{columns:2},Array.isArray(o)?o.map((e=>d(_,{value:e},e))):null==(t=Object.entries(o))?void 0:t.map((([e,t])=>d(_,{value:e},t)))))},Et=()=>{const{client:e}=Pt(),{client:t}=ft(),{client:n}=_t(),o=qe(H(t.getDepartments,[t]),[t]),[r,i]=u(null),l=qe(H(r?t.getCategories.bind(null,r):()=>Promise.reject("No dept selected"),[r]),[r]),[a,s]=u(null),c=Ge([]),h=Ge([]),[m,v]=B(!1),y=H((()=>{var n;r&&a&&(v.on(),t.getProducts(r,a).then((n=e,e=>n.Product.crud.getAll({sku:e.map((e=>e.ID)).join(",")}).then((t=>{const o=[],r=[];for(const n of e){const e=t.find((e=>e.sku===`${n.ID}`));e?r.push(Object.assign({id:e.id},ct(n))):o.push(ct(n))}return[...Ze(r,100).map((e=>n.Product.crud.batch({update:e}))),...Ze(o,100).map((e=>n.Product.crud.batch({create:e})))]})))).then((e=>e.map((e=>e.then((e=>{e.create&&c.concat(e.create),e.update&&h.concat(e.update)})))))).finally(v.off))}),[r,a]),g=Ge([]);p((()=>{e.Order.crud.list({status:"processing"}).then((e=>e.filter((e=>["authorize_net_cim_credit_card","yith_wcauthnet_credit_card_gateway"].includes(e.payment_method))))).then(g.set)}),[e]),console.log({dept:r,cat:a,syncing:m});const f=Ge([]);Ge([]);const[b,S]=B(!1),C=H((()=>{g&&f.array.length>0&&(S.on(),st(t,e,n)(g.array.filter((e=>f.array.includes(e.id.toString())))).then((e=>g.set([...g.array.filter((t=>null===e.find((e=>e.id===t.id)))),...e]))).finally(S.off))}),[f,t]);return d(O,null,d(P,{size:"lg"},"RB Integration Dashboard"),d(Ne,null,d(Le,{title:"Sync Products"},d(O,{w:"100%",alignItems:"stretch"},o.resolved?d(Lt,{onChange:i,options:o.resolved}):"Loading Deparments",l.resolved?d(Lt,{onChange:s,options:l.resolved}):"Loading Categories",d(T,{onClick:y,disabled:!r||!a||m},"Sync Products"),c.array.length>0||h.array.length>0?d(Nt,{headers:["ID#","Name","SKU","Regular Price & Sales Price","Storage Quantity"]},d(A,null,"Created ",c.array.length),c.array.map((e=>d(N,null,d(q,null,e.id),d(q,null,e.name),d(q,null,e.sku),d(q,null,e.regular_price,d("br",null),e.sale_price),d(q,null,e.stock_quantity)))),d(A,null,"Updated ",h.array.length),h.array.map((e=>d(N,null,d(q,null,e.id),d(q,null,e.name),d(q,null,e.sku),d(q,null,e.regular_price,d("br",null),e.sale_price),d(q,null,e.stock_quantity))))):null)),d(Le,{title:"Post Orders"},d(O,{alignItems:"stretch"},g.array?d(Nt,{headers:["","ID#","Status","CustomerID#"]},g.array.map((e=>d(N,null,d(q,null,d(x,{name:"order-ids",onChange:e=>{e.target.checked?f.push(e.target.value):f.remove(e.target.value)},value:e.id.toString(),checked:f.array.includes(e.id.toString())})),d(q,null,e.id),d(q,null,e.status),d(q,null,e.customer_id))))):"Loading Orders",d(T,{onClick:C,disabled:b},"Post Orders")))))},qt=({children:e})=>d(R,{status:"error"},d($,null),d(M,{mr:2},e),d(z,null)),Gt=()=>{const{optionInput:e,fetching:t,saving:n,options:o}=Be();return d(Ne,null,d(Le,{title:"Dashboard"},d(Ee,{clientID:o.gsc.options.access.clientID,gsgToken:o.gsc.options.access.gsgToken,companySN:o.evosus.access.companySN,ticket:o.evosus.access.ticket})),d(Le,{title:"Settings"},d(Z,null,e(o.evosus.access,"companySN","Company SN"),e(o.evosus.access,"ticket","Ticket"))))},Rt=()=>{const{optionInput:e,fetching:t,saving:n,options:o}=Be();return d(Ne,null,d(Le,{title:"Dashboard"},d(Ct,a({},o.wc.options),d(gt,a({},o.rb.options),d(wt,a({},o.an.options),d(Et,null))))),d(Le,{title:"Settings"},d(Z,null,e(o.rb.options.access,"CompanyID","Company ID"),e(o.rb.options.access,"APIKey","API Key"),e(o.rb.options.access,"name","Company Name"),e(o.an.options.credentials,"name","Authorize.net Name"),e(o.an.options.credentials,"transactionKey","Authorize.net Transaction Key"),e(o.an.options.credentials,"refId","Authorize.net Ref ID (Optional)"))))},$t=()=>{const{client:e}=At();Be();const{resolved:t,loading:n,rejected:o}=qe(e.getServices);return o?d(qt,null,"Failed to authenticate client, verify credentials under Settings"):t?d(Z,null,t.includes("Evosus")?d(te,{href:"/evosus"},"Evosus"):null,t.includes("RB")?d(te,{href:"/rb"},"RB"):null):d(ne,null)},Mt=()=>{const{optionInput:e,fetching:t,saving:n,options:o}=Be();return d(m,null,d(Ne,{defaultIndex:[0],allowMultiple:!1,allowToggle:!0},d(Le,{title:"Integrations"},d(t?ne:$t,null)),d(Le,{title:"Settings"},d(Z,{spacing:3},e(o.gsc.options.access,"clientID","Client ID"),e(o.gsc.options.access,"gsgToken","GSG Token"),e(o.wc.options.access,"key","WooCommerce API Key"),e(o.wc.options.access,"secret","WooCommerce API Secret"),e(o.wc.options.access,"url","Website URL")))))},zt=()=>{const{optionInput:e,fetching:t,saving:n,options:o}=Be();return d(ae,null,d(Z,null,d(ee,{as:"header",justifyContent:"center",alignItems:"center"},d(P,null,d(te,{href:"/"},"Get Smart Plugin")),t||n?d(ne,null):null),d(oe,{path:"/"},(e=>(console.dir(e),d(re,null,d(ie,null,d(le,{as:te,href:"/"},"Home")),e.path.includes("evosus")?d(ie,null,d(le,{as:te,href:"/evosus"},"Evosus")):null,e.path.includes("rb")?d(ie,null,d(le,{as:te,href:"/rb"},"RB")):null))))),d(Dt,a({},o.gsc.options),d(J,{history:X()},d(Y,{path:"/",component:Mt}),d(Y,{path:"/evosus",component:Gt}),d(Y,{path:"/rb",component:Rt}))))};var Bt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",ProductColors:({product:e})=>d(ye,null,d(Ce,{product:e})),WordpressDashboard:e=>d(Ue,a({},e),d(zt,null))});null==window||window.addEventListener("load",(()=>{document.querySelectorAll("[data-component]").forEach((e=>{const t=e.getAttribute("data-component"),n=e.getAttributeNames().reduce(((t,n)=>{if(n&&"data-component"!==n){const o=e.getAttribute(n);o&&(t[n]=o)}return t}),{});if(t){const o=Bt[t];o&&se(d(o,a({},n)),e)}}))}));
